window.w3term=function(e,t){function n(e,t){function n(e){for(var t=document.createElement("span"),n=t,a=e.indexOf("[");a>=0;){if(n.appendChild(document.createTextNode(e.substr(0,a))),"[0m"==e.substr(a,4))n=t,colorCode="[0m";else{colorCode=e.substr(a,5),"m"==colorCode.charAt(3)&&(colorCode=colorCode.substr(0,4));var r=o(colorCode);n.appendChild(r),n=r}e=e.substr(a+colorCode.length),a=e.indexOf("[")}return n.appendChild(document.createTextNode(e)),t}function o(e){var t=document.createElement("span");switch(e){case"[31m":t.style.color="red";break;case"[32m":t.style.color="green";break;case"[33m":t.style.color="yellow";break;case"[34m":t.style.color="blue";break;case"[35m":t.style.color="magenta";break;case"[36m":t.style.color="cyan";break;case"[37m":t.style.color="white";break;case"[41m":t.style.backgroundColor="red",t.classList.add("withBackground");break;case"[42m":t.style.backgroundColor="green",t.classList.add("withBackground");break;case"[43m":t.style.backgroundColor="yellow",t.classList.add("withBackground");break;case"[44m":t.style.backgroundColor="blue",t.classList.add("withBackground");break;case"[45m":t.style.backgroundColor="magenta",t.classList.add("withBackground");break;case"[46m":t.style.backgroundColor="cyan",t.classList.add("withBackground");break;case"[47m":t.style.backgroundColor="white",t.classList.add("withBackground");break;case"[1m":t.style.fontWeight="bold";break;case"[3m":t.style.fontStyle="italic";break;case"[4m":t.style.textDecoration="underline";break;case"[5m":for(var n=0;n<k.length;n++)console.log(k[n]),t.classList.add(k[n]);break;case"[7m":for(var n=0;n<b.length;n++)t.classList.add(b[n]);t.classList.add("withBackground");break;case"[92m":t.style.color="#00EE00";break;case"[95m":t.style.color="#660099";break;case"[94m":t.style.color="#3399FF";break;case"[93m":t.style.color="#FF9900";break;case"[91m":t.style.color="#990000"}return t}var a,r,c,i,d,u,m=[],p=0,f={prompt:"> ",historySize:100,stylePrefix:"",processCommand:function(e,t,n){console.log(t,n)}},h=this,C=!0,x=/([A-Za-z][^A-Za-z]|[0-9][^0-9])/g,g=["w3term-blink"],k=["w3term-textblink"],b=["w3term-textinverted"],v=e;l(h,f,t),v.className+=" w3term",a=document.createElement("input"),a.type="text",a.className="hiddenInput",r=document.createElement("span"),r.className="currentLine",r.tabindex=0,c=document.createElement("span"),c.className="prompt",c.textContent=f.prompt,i=document.createElement("span"),u=document.createElement("span"),d=document.createElement("span"),d.textContent=" ",d.className="textcursor w3term-blink",r.appendChild(c),r.appendChild(i),r.appendChild(d),r.appendChild(u),v.appendChild(r),v.appendChild(a),h.backspace=function(){i.textContent=i.textContent.slice(0,-1)},h.skipBackspace=function(){var e=[];for(x.lastIndex=0;null!=(match=x.exec(i.textContent.slice(0,-1)));)e.push(match.index);if(e.length>0){var t=e[e.length-1]+2;i.textContent=i.textContent.slice(0,t)}else i.textContent=""},h.delete=function(){d.textContent=u.textContent.slice(0,1),u.textContent=u.textContent.slice(1)},h.navigate=function(e){if(e!=i.textContent.length){var t=i.textContent+d.textContent+u.textContent;e>0?e<t.length?(i.textContent=t.substring(0,e),d.textContent=t.charAt(e),u.textContent=t.substring(e+1)):(i.textContent=t.substring(0,t.length-1),d.textContent=t.charAt(t.length-1),u.textContent=""):(e=0,i.textContent="",d.textContent=0==t.length?" ":t.charAt(0),u.textContent=t.substring(1));for(var n=0;g>n;n++)d.classList.remove(g[n]);setTimeout(function(){for(var e=0;g>e;e++)d.classList.add(g[e])},1e3)}},h.moveLeft=function(){h.navigate(i.textContent.length-1)},h.skipLeft=function(){var e=i.textContent;if(""!=e){var t=[];for(x.lastIndex=0;null!=(match=x.exec(e.slice(0,-1)));)t.push(match.index);if(t.length>0){var n=t[t.length-1]+2;h.navigate(n)}else h.home()}},h.moveRight=function(){h.navigate(i.textContent.length+1)},h.skipRight=function(){var e=u.textContent;if(x.lastIndex=0,match=x.exec(e)){var t=i.textContent.length+match.index+2;h.navigate(t)}else h.end()},h.home=function(){h.navigate(0)},h.end=function(){h.navigate(i.textContent.length+d.textContent.length+u.textContent.length-1)},h.enter=function(){var e=(i.textContent+d.textContent+u.textContent).trim(),t=document.createElement("p"),n=document.createElement("span");if(n.className="prompt",n.textContent=f.prompt,t.appendChild(n),t.appendChild(document.createTextNode(e)),v.insertBefore(t,r),i.textContent="",u.textContent="",d.textContent=" ",""!=e){var o=m.length;e!=m[o-1]&&(o<f.historySize||m.shift(),m.push(e)),p=m.length,f.processCommand(h,e,s(e))}c.textContent=f.prompt,h.scrollToBottom()},h.setInput=function(e){e=e.replace(/(?:\r\n|\r|\n)/g," "),i.textContent=e,d.textContent=" ",u.textContent=""},h.clear=function(){for(var e;e=v.getElementsByTagName("P")[0];)v.removeChild(e)},h.print=function(e,t){void 0===t&&(t=!0),e=e||"",t&&(e=e.replace(/&/g,"&amp;"),e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"));var o=n(e),a=r.previousSibling;if(a.classList.contains("output"))a.appendChild(o);else{var s=document.createElement("p");s.className="output",s.appendChild(o),v.insertBefore(s,r)}h.scrollToBottom()},h.println=function(e,t){h.print(e+"\n",t)},h.scrollToBottom=function(){v.scrollTop=v.scrollHeight},h.disableInput=function(){r.style.display="none",C=!1,a.blur()},h.enableInput=function(){r.style.display="inline",C=!0,a.focus()},h.setOptions=function(e){l(h,f,e)},h.setStylePrefix=function(e){oldStylePrefix=f.stylePrefix,f.stylePrefix=e;try{v.classList.remove(oldStylePrefix)}catch(t){}try{d.classList.remove(oldStylePrefix+"-blink"),d.classList.remove(oldStylePrefix+"-blink")}catch(t){}for(;g.length>1;)g.pop();for(;k.length>1;)k.pop();for(;b.length>1;)b.pop();e&&(v.classList.add(e),d.classList.add(e+"-blink"),g.push(e+"-blink"),k.push(e+"-textblink"),b.push(e+"-textinverted"))},v.onclick=function(){a.focus()},v.focus=function(){a.focus()},v.oninput=function(){i.textContent+=a.value,a.value=""},v.onkeydown=function(e){if(C){{var t=e.keyCode;i.textContent,u.textContent}switch(t){case 27:e.preventDefault();break;case 8:e.preventDefault(),e.altKey?h.skipBackspace():h.backspace();break;case 46:e.preventDefault(),h.delete();break;case 9:break;case 37:e.preventDefault(),e.ctrlKey?h.skipLeft():h.moveLeft();break;case 39:e.preventDefault(),e.ctrlKey?h.skipRight():h.moveRight();break;case 38:e.preventDefault();var n=p;n>0&&(n--,h.setInput(m[n]),p=n);break;case 40:e.preventDefault();var n=p;n<m.length&&(n++,h.setInput(n==m.length?"":m[n]),p=n);break;case 35:e.preventDefault(),h.end();break;case 36:e.preventDefault(),h.home();break;case 13:e.preventDefault(),h.enter()}}},t&&t.stylePrefix&&h.setStylePrefix(t.stylePrefix),v.focus()}function o(e){if(!e.tagName)throw"invalid node, w3term needs a DOM node as an argument";return"DIV"==e.tagName?a(e):(newNode=document.createElement("div"),e.parentNode.replaceChild(newNode,e),e=newNode),e}function a(e){for(;e.firstChild;)e.removeChild(e.firstChild)}function r(e,t,n){for(var o=n,a="",r=!1;n<t.length;n++)if(r||"\\"!=t.charAt(n)){if(t.charAt(n)==e){if(!r)break;a+=t.slice(o,n-1)+e,o=n+1}r=!1}else r=!0;return{arg:a+t.slice(o,n),i:n}}function s(e){for(var t=[],n=0;n<e.length;n++)'"'==e.charAt(n)?(result=r('"',e,n+1),t.push(result.arg),n=result.i+1):(result=r(" ",e,n),t.push(result.arg),n=result.i);return n<e.length&&t.push(e.slice(n,e.length)),t}function l(e,t,n){n=n||{},void 0!==n.prompt&&(t.prompt=n.prompt),void 0!==n.historySize&&(t.historySize=n.historySize),void 0!==n.processCommand&&(t.processCommand=n.processCommand),n.stylePrefix&&e.setStylePrefix&&e.setStylePrefix(n.stylePrefix)}return e=o(e),e.w3term=new n(e,t),e};
